
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Maxwell 2D - Simplified ion trap modeling &#8212; PyAnsys Workflows</title>
  
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/ansys-sphinx-theme.css?v=a23b20f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/ansys-sphinx-theme.css?v=a23b20f3" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" type="text/css" href="https://www.nerdfonts.com/assets/css/webfont.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />


  <!-- Include desired assets -->
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  

  
    <link href="../../_static/css/breadcrumbs.css" rel="stylesheet" />
  
    <script src="../../_static/documentation_options.js?v=38b66d78"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/maxwell2d-lumerical/wf_ml_01_ion_trap_modelling';</script>
    <link rel="icon" href="../../_static/ansys-favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Maxwell 2D and Lumerical" href="index.html" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.1.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="https://docs.pyansys.com/">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/pyansys_logo_transparent_black.png" class="logo__image only-light" alt="PyAnsys Workflows - Home"/>
    <img src="../../_static/pyansys_logo_transparent_white.png" class="logo__image only-dark pst-js-only" alt="PyAnsys Workflows - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">

<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../index.html" title="PyAnsys Workflows home">Home</a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../examples.html">
    Workflow examples
  </a>
</li>

  </ul>
</nav>
</div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<div class="search-bar pst-js-only" id="search-bar">
  <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
    <i class="fa-solid fa-magnifying-glass"></i>
    <input type="search" class="form-control" name="q" placeholder="Search the docs ..."
      aria-label="Search the docs ..." autocomplete="off" autocorrect="off"
      autocapitalize="off" spellcheck="false" />
    <span class="search-button__kbd-shortcut">
      <kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd>
    </span>
  </form>
  
  <div id="static-search-results" class="static-search-results" style="display:none;" tabindex="0"></div>
  
</div></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyansys-workflows" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyansys-workflows/discussions" title="Support" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comment fa-fw fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Support</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  
  


  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">

<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../index.html" title="PyAnsys Workflows home">Home</a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../examples.html">
    Workflow examples
  </a>
</li>

  </ul>
</nav>
</div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="search-bar pst-js-only" id="search-bar">
  <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
    <i class="fa-solid fa-magnifying-glass"></i>
    <input type="search" class="form-control" name="q" placeholder="Search the docs ..."
      aria-label="Search the docs ..." autocomplete="off" autocorrect="off"
      autocapitalize="off" spellcheck="false" />
    <span class="search-button__kbd-shortcut">
      <kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd>
    </span>
  </form>
  
  <div id="static-search-results" class="static-search-results" style="display:none;" tabindex="0"></div>
  
</div></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyansys-workflows" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ansys/pyansys-workflows/discussions" title="Support" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa fa-comment fa-fw fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Support</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../fluent-mechanical/index.html">Fluent and mechanical heat transfer workflow for exhaust manifold</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geometry-mesh/index.html">Geometry and meshing workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geometry-mesh-fluent/index.html">Geometry, meshing and fluids workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mapdl-dpf/index.html">MAPDL and DPF workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speos-optislang/index.html">Speos, optiSLang workflow</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Maxwell 2D and Lumerical</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Maxwell 2D - Simplified ion trap modeling</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">
<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
         
    <li class="breadcrumb-item breadcrumb-home">
      <a href="https://docs.pyansys.com/" class="nav-link">PyAnsys</a>
    </li>
     
    <li class="breadcrumb-item">
      <a
        href="../../index.html"
        class="nav-link"
        aria-label="Home"
      >
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
     
    <li class="breadcrumb-item">
      <a href="../../examples.html" class="nav-link">Workflow examples</a>
    </li>
     
    <li class="breadcrumb-item">
      <a href="index.html" class="nav-link">Maxwell 2D and Lumerical</a>
    </li>
      
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Maxwell 2D - Simplified ion trap modeling</span></li>
    
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-examples-maxwell2d-lumerical-wf-ml-01-ion-trap-modelling-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="maxwell-2d-simplified-ion-trap-modeling">
<span id="ref-wf-ml-01-ion-trap-modelling"></span><span id="sphx-glr-examples-maxwell2d-lumerical-wf-ml-01-ion-trap-modelling-py"></span><h1>Maxwell 2D - Simplified ion trap modeling<a class="headerlink" href="#maxwell-2d-simplified-ion-trap-modeling" title="Link to this heading">#</a></h1>
<section id="problem-description">
<h2>Problem description<a class="headerlink" href="#problem-description" title="Link to this heading">#</a></h2>
<p>Surface electrodes adjacent to grating couplers render an integrated ion trap.
In this workflow surface electrodes are modeled using ANSYS Maxwell and grating couplers using
ANSYS Lumerical. ANSYS Maxwell electrostatic solver, based on the finite element method, allows to
evaluate the ion trap height.Then the coordinates of the ion trap are passed to an optimization
algorithm to define the optimal two dimensional grating coupler design, which will focus the laser
beam at the ion trap height.</p>
<p>The workflow is explained in detail in this article:
<a class="reference external" href="https://optics.ansys.com/hc/en-us/articles/20715978394131-Integrated-Ion-Traps-using-Surface-Electrodes-and-Grating-Couplers">https://optics.ansys.com/hc/en-us/articles/20715978394131-Integrated-Ion-Traps-using-Surface-Electrodes-and-Grating-Couplers</a></p>
<p>The workflow consists of these steps:
- Set up the Maxwell 2D parametric model.
- Identify the electric field node point for each design point.
- Export the node coordinates for the subsequent Lumerical step.
- Launch the Lumerical scripts.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Perform required imports</span>
<span class="c1"># ------------------------</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ansys.aedt.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Maxwell2d</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ansys.lumerical.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">FDTD</span>
</pre></div>
</div>
</section>
<section id="prepare-and-launch-maxwell">
<h2>Prepare and launch Maxwell<a class="headerlink" href="#prepare-and-launch-maxwell" title="Link to this heading">#</a></h2>
<p>Define constants.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">AEDT_VERSION</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.html#os.getenv" title="os.getenv" class="sphx-glr-backref-module-os sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">getenv</span></a><span class="p">(</span><span class="s2">&quot;AEDT_VERSION&quot;</span><span class="p">,</span> <span class="s2">&quot;2025.2&quot;</span><span class="p">)</span>  <span class="c1"># Set your AEDT version here</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">NUM_CORES</span></a> <span class="o">=</span> <span class="mi">4</span>
<a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">NG_MODE</span></a> <span class="o">=</span> <span class="p">(</span>
    <a href="https://docs.python.org/3/library/os.html#os.getenv" title="os.getenv" class="sphx-glr-backref-module-os sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">getenv</span></a><span class="p">(</span><span class="s2">&quot;ON_CI&quot;</span><span class="p">,</span> <span class="s2">&quot;false&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;true&quot;</span>
<span class="p">)</span>  <span class="c1"># Open AEDT UI when it is launched, unless running in CI</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">NODE_FILENAME</span></a> <span class="o">=</span> <span class="s2">&quot;NodePositionTable.tab&quot;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LEGEND_FILENAME</span></a> <span class="o">=</span> <span class="s2">&quot;legend.txt&quot;</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PARENT_DIR_PATH</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>

<span class="c1"># Create temporary directory.</span>

<a href="https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryDirectory" title="tempfile.TemporaryDirectory" class="sphx-glr-backref-module-tempfile sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">temp_folder</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryDirectory" title="tempfile.TemporaryDirectory" class="sphx-glr-backref-module-tempfile sphx-glr-backref-type-py-class"><span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span></a><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.ansys&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lumerical_script_folder</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">temp_folder</span><span class="o">.</span><span class="n">name</span></a><span class="p">)</span>  <span class="c1"># / &quot;lumerical_scripts&quot;</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">node_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lumerical_script_folder</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">NODE_FILENAME</span></a>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">legend_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lumerical_script_folder</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">LEGEND_FILENAME</span></a>

<span class="c1"># Launch AEDT and start a Maxwell 2D design.</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">project_name</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.join" title="os.path.join" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">temp_folder</span><span class="o">.</span><span class="n">name</span></a><span class="p">,</span> <span class="s2">&quot;IonTrapMaxwell.aedt&quot;</span><span class="p">)</span>
<span class="n">m2d</span> <span class="o">=</span> <span class="n">Maxwell2d</span><span class="p">(</span>
    <span class="n">project</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">project_name</span></a><span class="p">,</span>
    <span class="n">design</span><span class="o">=</span><span class="s2">&quot;01_IonTrap_3binary2D&quot;</span><span class="p">,</span>
    <span class="n">solution_type</span><span class="o">=</span><span class="s2">&quot;Electrostatic&quot;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">AEDT_VERSION</span></a><span class="p">,</span>
    <span class="n">non_graphical</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">NG_MODE</span></a><span class="p">,</span>
    <span class="n">new_desktop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">m2d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">model_units</span> <span class="o">=</span> <span class="s2">&quot;um&quot;</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>PyAEDT INFO: Python version 3.12.7 (tags/v3.12.7:0b05ead, Oct  1 2024, 03:06:41) [MSC v.1941 64 bit (AMD64)].
PyAEDT INFO: PyAEDT version 0.17.3.
PyAEDT INFO: Initializing new Desktop session.
PyAEDT INFO: Log on console is enabled.
PyAEDT INFO: Log on file C:\Users\ansys\AppData\Local\Temp\pyaedt_ansys_7ac373aa-50e5-4ede-bf43-7037881bf476.log is enabled.
PyAEDT INFO: Log on AEDT is disabled.
PyAEDT INFO: Debug logger is disabled. PyAEDT methods will not be logged.
PyAEDT INFO: Launching PyAEDT with gRPC plugin.
PyAEDT INFO: New AEDT session is starting on gRPC port 54796.
PyAEDT INFO: Electronics Desktop started on gRPC port: 54796 after 11.785527467727661 seconds.
PyAEDT INFO: AEDT installation Path C:\Program Files\ANSYS Inc\v252\AnsysEM
PyAEDT INFO: Ansoft.ElectronicsDesktop.2025.2 version started with process ID 8292.
PyAEDT INFO: Project IonTrapMaxwell has been created.
PyAEDT INFO: Added design &#39;01_IonTrap_3binary2D&#39; of type Maxwell 2D.
PyAEDT INFO: Aedt Objects correctly read
PyAEDT INFO: Modeler2D class has been initialized!
PyAEDT INFO: Modeler class has been initialized! Elapsed time: 0m 0sec
</pre></div>
</div>
</section>
<section id="preprocess">
<h2>Preprocess<a class="headerlink" href="#preprocess" title="Link to this heading">#</a></h2>
<p>The preprocessing is performed using the following steps:
1. Define design variables.
2. Create design geometry.
3. Define excitations.
4. (Optional) Define mesh settings.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize dictionaries for design variables.</span>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geom_params</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;div&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="mi">73</span> <span class="o">/</span> <span class="mi">41</span><span class="p">),</span>
    <span class="s2">&quot;w_rf&quot;</span><span class="p">:</span> <span class="s2">&quot;41um&quot;</span><span class="p">,</span>
    <span class="s2">&quot;w_dc&quot;</span><span class="p">:</span> <span class="s2">&quot;41um*div&quot;</span><span class="p">,</span>
    <span class="s2">&quot;w_cut&quot;</span><span class="p">:</span> <span class="s2">&quot;4um&quot;</span><span class="p">,</span>
    <span class="s2">&quot;metal_thickness&quot;</span><span class="p">:</span> <span class="s2">&quot;1um&quot;</span><span class="p">,</span>
    <span class="s2">&quot;offset_glass&quot;</span><span class="p">:</span> <span class="s2">&quot;50um&quot;</span><span class="p">,</span>
    <span class="s2">&quot;glass_thickness&quot;</span><span class="p">:</span> <span class="s2">&quot;10um&quot;</span><span class="p">,</span>
    <span class="s2">&quot;x_dummy&quot;</span><span class="p">:</span> <span class="s2">&quot;2um&quot;</span><span class="p">,</span>
    <span class="s2">&quot;y_dummy&quot;</span><span class="p">:</span> <span class="s2">&quot;300um&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Define design variables from dictionaries</span>

<span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">v</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geom_params</span></a><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">m2d</span><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k</span></a><span class="p">]</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">v</span></a>

<span class="c1"># Create design geometry</span>

<span class="n">dc</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span>
    <span class="n">origin</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-w_dc/2&quot;</span><span class="p">,</span> <span class="s2">&quot;-metal_thickness/2&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">],</span>
    <span class="n">sizes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;w_dc&quot;</span><span class="p">,</span> <span class="s2">&quot;metal_thickness&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;DC&quot;</span><span class="p">,</span>
    <span class="n">material</span><span class="o">=</span><span class="s2">&quot;aluminum&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># dc.color = (0, 0, 255)  # rgb</span>

<span class="n">gnd</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span>
    <span class="n">origin</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-(w_dc/2+w_cut+w_rf+offset_glass)&quot;</span><span class="p">,</span> <span class="s2">&quot;-(metal_thickness/2+glass_thickness)&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">],</span>
    <span class="n">sizes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;2*(w_dc/2+w_cut+w_rf+offset_glass)&quot;</span><span class="p">,</span> <span class="s2">&quot;-metal_thickness&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;gnd&quot;</span><span class="p">,</span>
    <span class="n">material</span><span class="o">=</span><span class="s2">&quot;aluminum&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">rf</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span>
    <span class="n">origin</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-(w_dc/2+w_cut+w_rf)&quot;</span><span class="p">,</span> <span class="s2">&quot;-metal_thickness/2&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">],</span>
    <span class="n">sizes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;w_rf&quot;</span><span class="p">,</span> <span class="s2">&quot;metal_thickness&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;RF&quot;</span><span class="p">,</span>
    <span class="n">material</span><span class="o">=</span><span class="s2">&quot;aluminum&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">sub_glass</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span>
    <span class="n">origin</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-(w_dc/2+w_cut+w_rf+offset_glass)&quot;</span><span class="p">,</span> <span class="s2">&quot;-metal_thickness/2&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">],</span>
    <span class="n">sizes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;2*(w_dc/2+w_cut+w_rf+offset_glass)&quot;</span><span class="p">,</span> <span class="s2">&quot;-glass_thickness&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;RF&quot;</span><span class="p">,</span>
    <span class="n">material</span><span class="o">=</span><span class="s2">&quot;glass&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ins</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span>
    <span class="n">origin</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-(w_dc/2+w_cut)&quot;</span><span class="p">,</span> <span class="s2">&quot;-metal_thickness/2&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">],</span>
    <span class="n">sizes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;w_cut&quot;</span><span class="p">,</span> <span class="s2">&quot;metal_thickness&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ins&quot;</span><span class="p">,</span>
    <span class="n">material</span><span class="o">=</span><span class="s2">&quot;vacuum&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Create dummy objects for mesh and center line for postprocessing and region</span>

<span class="n">dummy</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_rectangle</span><span class="p">(</span>
    <span class="n">origin</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;metal_thickness/2&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">],</span>
    <span class="n">sizes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-x_dummy&quot;</span><span class="p">,</span> <span class="s2">&quot;y_dummy&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;dummy&quot;</span><span class="p">,</span>
    <span class="n">material</span><span class="o">=</span><span class="s2">&quot;vacuum&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Create region</span>

<span class="n">region</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_region</span><span class="p">(</span>
    <span class="n">pad_value</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pad_type</span><span class="o">=</span><span class="s2">&quot;Absolute Offset&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Region&quot;</span>
<span class="p">)</span>

<span class="c1"># Create the center line for electric field maximum point identification</span>

<span class="n">center_line</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_polyline</span><span class="p">(</span>
    <span class="n">points</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;metal_thickness/2&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;metal_thickness/2+200um&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">]],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;center_line&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Define excitations</span>

<span class="n">m2d</span><span class="o">.</span><span class="n">assign_voltage</span><span class="p">(</span><span class="n">assignment</span><span class="o">=</span><span class="n">gnd</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ground&quot;</span><span class="p">)</span>
<span class="n">m2d</span><span class="o">.</span><span class="n">assign_voltage</span><span class="p">(</span><span class="n">assignment</span><span class="o">=</span><span class="n">dc</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;V_dc&quot;</span><span class="p">)</span>
<span class="n">m2d</span><span class="o">.</span><span class="n">assign_voltage</span><span class="p">(</span><span class="n">assignment</span><span class="o">=</span><span class="n">rf</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;V_rf&quot;</span><span class="p">)</span>

<span class="c1"># Define mesh settings</span>
<span class="c1"># For good quality results, uncomment the following mesh operations lines</span>
<span class="c1">#</span>
<span class="c1"># m2d.mesh.assign_length_mesh(</span>
<span class="c1">#     assignment=center_line.id,</span>
<span class="c1">#     maximum_length=1e-7,</span>
<span class="c1">#     maximum_elements=None,</span>
<span class="c1">#     name=&quot;center_line_0.1um&quot;,</span>
<span class="c1"># )</span>
<span class="c1"># m2d.mesh.assign_length_mesh(</span>
<span class="c1">#     assignment=dummy.name, maximum_length=2e-6, maximum_elements=1e6, name=&quot;dummy_2um&quot;</span>
<span class="c1"># )</span>
<span class="c1"># m2d.mesh.assign_length_mesh(</span>
<span class="c1">#     assignment=ins.id,</span>
<span class="c1">#     maximum_length=8e-7,</span>
<span class="c1">#     inside_selection=False,</span>
<span class="c1">#     maximum_elements=1e6,</span>
<span class="c1">#     name=&quot;ins_0.8um&quot;,</span>
<span class="c1"># )</span>
<span class="c1"># m2d.mesh.assign_length_mesh(</span>
<span class="c1">#     assignment=[dc.id, rf.id],</span>
<span class="c1">#     maximum_length=5e-6,</span>
<span class="c1">#     inside_selection=False,</span>
<span class="c1">#     maximum_elements=1e6,</span>
<span class="c1">#     name=&quot;dc_5um&quot;,</span>
<span class="c1"># )</span>
<span class="c1"># m2d.mesh.assign_length_mesh(</span>
<span class="c1">#     assignment=gnd.id,</span>
<span class="c1">#     maximum_length=1e-5,</span>
<span class="c1">#     inside_selection=False,</span>
<span class="c1">#     maximum_elements=1e6,</span>
<span class="c1">#     name=&quot;gnd_10um&quot;,</span>
<span class="c1"># )</span>

<span class="c1"># Duplicate structures and assignments to complete the model</span>

<span class="n">m2d</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">duplicate_and_mirror</span><span class="p">(</span>
    <span class="n">assignment</span><span class="o">=</span><span class="p">[</span><span class="n">rf</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">dummy</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">ins</span><span class="o">.</span><span class="n">id</span><span class="p">],</span>
    <span class="n">origin</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">],</span>
    <span class="n">vector</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-1&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">],</span>
    <span class="n">duplicate_assignment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>PyAEDT INFO: Materials class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: Boundary Voltage ground has been created.
PyAEDT INFO: Boundary Voltage V_dc has been created.
PyAEDT INFO: Boundary Voltage V_rf has been created.

[&#39;RF_2&#39;, &#39;dummy_1&#39;, &#39;ins_1&#39;]
</pre></div>
</div>
</section>
<section id="run-simulation-and-parametric-sweep">
<h2>Run simulation and parametric sweep<a class="headerlink" href="#run-simulation-and-parametric-sweep" title="Link to this heading">#</a></h2>
<p>Create, validate, and analyze setup</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">setup_name</span></a> <span class="o">=</span> <span class="s2">&quot;MySetupAuto&quot;</span>
<span class="n">setup</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">create_setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">setup_name</span></a><span class="p">)</span>
<span class="n">setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;PercentError&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">setup</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="n">m2d</span><span class="o">.</span><span class="n">validate_simple</span><span class="p">()</span>
<span class="n">m2d</span><span class="o">.</span><span class="n">analyze_setup</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">setup_name</span></a><span class="p">,</span> <span class="n">use_auto_settings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cores</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">NUM_CORES</span></a><span class="p">)</span>

<span class="c1">#  Create and solve parametric sweep</span>
<span class="c1">#  Keeping w_rf constant, recompute the w_dc values from the desired ratios w_rf/w_dc</span>

<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">div_sweep_start</span></a> <span class="o">=</span> <span class="mf">1.4</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">div_sweep_stop</span></a> <span class="o">=</span> <span class="mi">2</span>
<span class="n">sweep</span> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">parametrics</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;div&quot;</span><span class="p">,</span>
    <span class="n">start_point</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">div_sweep_start</span></a><span class="p">,</span>
    <span class="n">end_point</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">div_sweep_stop</span></a><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">variation_type</span><span class="o">=</span><span class="s2">&quot;LinearStep&quot;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;w_dc_sweep&quot;</span><span class="p">,</span>
<span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">add_points</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">add_points</span></a><span class="p">:</span>
    <span class="n">sweep</span><span class="o">.</span><span class="n">add_variation</span><span class="p">(</span><span class="n">sweep_variable</span><span class="o">=</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">start_point</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p</span></a><span class="p">,</span> <span class="n">variation_type</span><span class="o">=</span><span class="s2">&quot;SingleValue&quot;</span><span class="p">)</span>
<span class="n">sweep</span><span class="p">[</span><span class="s2">&quot;SaveFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">sweep</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">NUM_CORES</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>PyAEDT INFO: Key Desktop/ActiveDSOConfigurations/Maxwell 2D correctly changed.
PyAEDT INFO: Solving design setup MySetupAuto
PyAEDT INFO: Key Desktop/ActiveDSOConfigurations/Maxwell 2D correctly changed.
PyAEDT INFO: Design setup MySetupAuto solved correctly in 0.0h 0.0m 9.0s
PyAEDT INFO: Parsing C:/Users/ansys/AppData/Local/Temp/tmp675ty9qt.ansys/IonTrapMaxwell.aedt.
PyAEDT INFO: File C:/Users/ansys/AppData/Local/Temp/tmp675ty9qt.ansys/IonTrapMaxwell.aedt correctly loaded. Elapsed time: 0m 0sec
PyAEDT INFO: aedt file load time 0.0
PyAEDT INFO: Key Desktop/ActiveDSOConfigurations/Maxwell 2D correctly changed.
PyAEDT INFO: Solving Optimetrics
PyAEDT INFO: Key Desktop/ActiveDSOConfigurations/Maxwell 2D correctly changed.
PyAEDT INFO: Design setup w_dc_sweep solved correctly in 0.0h 0.0m 38.0s

True
</pre></div>
</div>
</section>
<section id="postprocess">
<h2>Postprocess<a class="headerlink" href="#postprocess" title="Link to this heading">#</a></h2>
<p>Create the Ey expression in the PyAEDT advanced field calculator.
Due to the symmetric nature of this specific geometry, the electric field
node will be located along the center line. The electric field node is the
point where the Ey will be zero and can be found directly by Maxwell
postprocessing features.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">e_line</span></a> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">fields_calculator</span><span class="o">.</span><span class="n">add_expression</span><span class="p">(</span><span class="n">calculation</span><span class="o">=</span><span class="s2">&quot;e_line&quot;</span><span class="p">,</span> <span class="n">assignment</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">my_plots</span></a> <span class="o">=</span> <span class="n">m2d</span><span class="o">.</span><span class="n">post</span><span class="o">.</span><span class="n">fields_calculator</span><span class="o">.</span><span class="n">expression_plot</span><span class="p">(</span>
    <span class="n">calculation</span><span class="o">=</span><span class="s2">&quot;e_line&quot;</span><span class="p">,</span> <span class="n">assignment</span><span class="o">=</span><span class="s2">&quot;center_line&quot;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">e_line</span></a><span class="p">]</span>
<span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">my_plots</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">edit_x_axis_scaling</span><span class="p">(</span><span class="n">min_scale</span><span class="o">=</span><span class="s2">&quot;20um&quot;</span><span class="p">,</span> <span class="n">max_scale</span><span class="o">=</span><span class="s2">&quot;200um&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">my_plots</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">update_trace_in_report</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">my_plots</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_solution_data</span><span class="p">()</span><span class="o">.</span><span class="n">expressions</span><span class="p">,</span> <span class="n">variations</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;div&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">]},</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;center_line&quot;</span>
<span class="p">)</span>

<span class="c1"># Identify the zero point for each trace</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">my_plots</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_cartesian_y_marker</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">my_plots</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_trace_characteristics</span><span class="p">(</span>
    <span class="s2">&quot;XAtYVal&quot;</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">],</span> <span class="n">solution_range</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Full&quot;</span><span class="p">,</span> <span class="s2">&quot;20&quot;</span><span class="p">,</span> <span class="s2">&quot;200&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Export the points at which Ey=0 to a TXT file</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">my_plots</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">export_table_to_file</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">my_plots</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">node_path</span></a><span class="p">),</span> <span class="n">table_type</span><span class="o">=</span><span class="s2">&quot;Legend&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>PyAEDT INFO: PostProcessor class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: PostProcessor class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: Post class has been initialized! Elapsed time: 0m 0sec
PyAEDT INFO: Solution Data Correctly Loaded.

True
</pre></div>
</div>
</section>
<section id="prepare-and-run-lumerical-simulation">
<h2>Prepare and run Lumerical simulation<a class="headerlink" href="#prepare-and-run-lumerical-simulation" title="Link to this heading">#</a></h2>
<p>Edit the file outputted by Maxwell to be read in by Lumerical</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">new_line</span></a> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">node_path</span></a><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lines</span></a> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">new_line</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lines</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lines</span></a><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">new_line</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line</span></a><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">new_line</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line</span></a><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">legend_path</span></a><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">new_line</span></a><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">line</span></a><span class="p">)</span>

<span class="c1"># Copy Lumerical scripts and illustration to the local folder</span>

<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gc_farfiled_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/shutil.html#shutil.copy" title="shutil.copy" class="sphx-glr-backref-module-shutil sphx-glr-backref-type-py-function"><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PARENT_DIR_PATH</span></a> <span class="o">/</span> <span class="s2">&quot;GC_farfield.lsf&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lumerical_script_folder</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gc_opt_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/shutil.html#shutil.copy" title="shutil.copy" class="sphx-glr-backref-module-shutil sphx-glr-backref-type-py-function"><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PARENT_DIR_PATH</span></a> <span class="o">/</span> <span class="s2">&quot;GC_Opt.lsf&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lumerical_script_folder</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">read_data_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/shutil.html#shutil.copy" title="shutil.copy" class="sphx-glr-backref-module-shutil sphx-glr-backref-type-py-function"><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PARENT_DIR_PATH</span></a> <span class="o">/</span> <span class="s2">&quot;Readata.lsf&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lumerical_script_folder</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">img_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/shutil.html#shutil.copy" title="shutil.copy" class="sphx-glr-backref-module-shutil sphx-glr-backref-type-py-function"><span class="n">shutil</span><span class="o">.</span><span class="n">copy</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PARENT_DIR_PATH</span></a> <span class="o">/</span> <span class="s2">&quot;img_001.jpg&quot;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lumerical_script_folder</span></a><span class="p">)</span>

<span class="c1"># Start the Lumerical process</span>

<span class="n">gc_0</span> <span class="o">=</span> <span class="n">FDTD</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gc_opt_path</span></a><span class="p">)</span>

<span class="c1"># Run the first script: build geometry and run optimization</span>

<span class="n">gc_1</span> <span class="o">=</span> <span class="n">FDTD</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">read_data_path</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Optimize for the nodal point located&quot;</span><span class="p">,</span>
    <span class="nb">str</span><span class="p">(</span><span class="n">gc_1</span><span class="o">.</span><span class="n">getv</span><span class="p">(</span><span class="s2">&quot;T5&quot;</span><span class="p">)),</span>
    <span class="s2">&quot;um, above the linearly apodized grating coupler&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Run the optimized design</span>

<span class="n">gc_2</span> <span class="o">=</span> <span class="n">FDTD</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lumerical_script_folder</span></a> <span class="o">/</span> <span class="s2">&quot;Testsim_Intensity_best_solution&quot;</span><span class="p">))</span>
<span class="n">gc_2</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lumerical_script_folder</span></a> <span class="o">/</span> <span class="s2">&quot;GC_farfields_calc&quot;</span><span class="p">))</span>
<span class="n">gc_2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># Run the second script for calculating plots</span>

<span class="n">gc_2</span><span class="o">.</span><span class="n">feval</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gc_farfiled_path</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Target focal distance of output laser beam: </span><span class="si">{</span><span class="n">gc_2</span><span class="o">.</span><span class="n">getv</span><span class="p">(</span><span class="s1">&#39;Mselect&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000000</span><span class="si">}</span><span class="s2"> (um)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Actual focal distance for the optimised geometry: </span><span class="si">{</span><span class="n">gc_2</span><span class="o">.</span><span class="n">getv</span><span class="p">(</span><span class="s1">&#39;Mactual&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000000</span><span class="si">}</span><span class="s2"> (um)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Relative error: </span><span class="si">{</span><span class="n">gc_2</span><span class="o">.</span><span class="n">getv</span><span class="p">(</span><span class="s1">&#39;RelVal&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FWHM of vertical direction at focus: </span><span class="si">{</span><span class="n">gc_2</span><span class="o">.</span><span class="n">getv</span><span class="p">(</span><span class="s1">&#39;FWHM_X&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000000</span><span class="si">}</span><span class="s2"> (um)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FWHM of horizontal direction at focus </span><span class="si">{</span><span class="n">gc_2</span><span class="o">.</span><span class="n">getv</span><span class="p">(</span><span class="s1">&#39;FWHM_Y&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000000</span><span class="si">}</span><span class="s2"> (um)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Substrate material : </span><span class="si">{</span><span class="n">gc_2</span><span class="o">.</span><span class="n">getv</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Waveguide etch depth: </span><span class="si">{</span><span class="n">gc_2</span><span class="o">.</span><span class="n">getv</span><span class="p">(</span><span class="s1">&#39;GC_etch&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000000000</span><span class="si">}</span><span class="s2"> (nm)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Grating period (P): </span><span class="si">{</span><span class="n">gc_2</span><span class="o">.</span><span class="n">getv</span><span class="p">(</span><span class="s1">&#39;GC_period&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000000000</span><span class="si">}</span><span class="s2"> (nm)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Grating minimum duty cycle: </span><span class="si">{</span><span class="n">gc_2</span><span class="o">.</span><span class="n">getv</span><span class="p">(</span><span class="s1">&#39;GC_DCmin&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Display grating schema image</span>


<span class="k">def</span><span class="w"> </span><span class="nf">in_ipython</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">IPython</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_ipython</span>

        <span class="k">return</span> <span class="n">get_ipython</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="n">schema_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.WindowsPath" title="pathlib.WindowsPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PARENT_DIR_PATH</span></a> <span class="o">/</span> <span class="s2">&quot;img_001.jpg&quot;</span><span class="p">)</span>

<span class="c1"># Show image inside IPython / Jupyter</span>
<span class="k">if</span> <span class="n">in_ipython</span><span class="p">():</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>

    <span class="n">display</span><span class="p">(</span><span class="n">schema_img</span><span class="p">)</span>
<span class="c1"># Show image using default image viewer</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">schema_img</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">schema_img</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Optimize for the nodal point located 81.2853 um, above the linearly apodized grating coupler
Target focal distance of output laser beam: 81.28529999999999 (um)
Actual focal distance for the optimised geometry: 80.48048048048048 (um)
Relative error: 1.0000182835820919%
FWHM of vertical direction at focus: 0.0 (um)
FWHM of horizontal direction at focus 26.360360360360364 (um)
Substrate material : SiO2 (Glass) - Palik
Waveguide etch depth: 300.0 (nm)
Grating period (P): 875.9113724877393 (nm)
Grating minimum duty cycle: 0.14446321676095913
</pre></div>
</div>
</section>
<section id="exit-the-solver">
<h2>Exit the solver<a class="headerlink" href="#exit-the-solver" title="Link to this heading">#</a></h2>
<p>Close FDTD projects and release AEDT</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">gc_0</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">gc_1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">gc_2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">m2d</span><span class="o">.</span><span class="n">save_project</span><span class="p">()</span>
<span class="n">m2d</span><span class="o">.</span><span class="n">desktop_class</span><span class="o">.</span><span class="n">release_desktop</span><span class="p">()</span>

<span class="c1"># Wait three seconds to allow AEDT to shut down before cleaning the temporary directory</span>
<a href="https://docs.python.org/3/library/time.html#time.sleep" title="time.sleep" class="sphx-glr-backref-module-time sphx-glr-backref-type-py-function"><span class="n">time</span><span class="o">.</span><span class="n">sleep</span></a><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Clean up the temporary folder</span>
<a href="https://docs.python.org/3/library/tempfile.html#tempfile.TemporaryDirectory.cleanup" title="tempfile.TemporaryDirectory.cleanup" class="sphx-glr-backref-module-tempfile sphx-glr-backref-type-py-method"><span class="n">temp_folder</span><span class="o">.</span><span class="n">cleanup</span></a><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>PyAEDT INFO: Project IonTrapMaxwell Saved correctly
PyAEDT INFO: Desktop has been released and closed.
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (40 minutes 4.147 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-maxwell2d-lumerical-wf-ml-01-ion-trap-modelling-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5af9a73ca477f3477b3872ee43b139a8/wf_ml_01_ion_trap_modelling.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">wf_ml_01_ion_trap_modelling.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c497897939fca80f2f2ae048c7216fa2/wf_ml_01_ion_trap_modelling.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">wf_ml_01_ion_trap_modelling.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/550d195b8becebf4dad173f564d2cc6b/wf_ml_01_ion_trap_modelling.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">wf_ml_01_ion_trap_modelling.zip</span></code></a></p>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-description">Problem description</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-and-launch-maxwell">Prepare and launch Maxwell</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocess">Preprocess</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-simulation-and-parametric-sweep">Run simulation and parametric sweep</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#postprocess">Postprocess</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-and-run-lumerical-simulation">Prepare and run Lumerical simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exit-the-solver">Exit the solver</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <ul class="this-page-menu">
      <li><a href="../../_sources/examples/maxwell2d-lumerical/wf_ml_01_ion_trap_modelling.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>


  <!-- Include desired assets -->
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.7/require.min.js"></script>

<script>
// Passing the search options to the search.js file
const SEARCH_OPTIONS = JSON.parse('{"keys": ["title", "text", "objectID"], "limit": 10, "threshold": 0.2}');
const SEARCH_FILE = "../../_static/search.json";
const ADVANCE_SEARCH_PATH = "../../search.html";
const EXTRA_SOURCES = JSON.parse('""');
</script>


<script src="../../_static/js/search.js"></script>

  
  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
       Copyright (c) 2026 ANSYS, Inc. All rights reserved.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.0.4.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<!--
  Theme Version Footer
  Displays the Sphinx theme version and the last updated date.
  Accessibility and semantic improvements included.
-->
<footer class="theme-version" aria-label="Theme version and last update">
  <span>
    
      Built with the
      <a href="https://sphinxdocs.ansys.com/version/stable/index.html" target="_blank" rel="noopener noreferrer">
        Ansys Sphinx Theme
      </a>
      1.7.0.
    
  </span>
  <br />
  <span>Last updated on <time id="ast_build_date"></time></span>
</footer>
<script>
  // Set the last updated date in a readable format
  (function() {
    var options = { day: "numeric", month: "long", year: "numeric" };
    var ast_lastModifiedDate = new Date(document.lastModified);
    var ast_build_date = ast_lastModifiedDate.toLocaleDateString("en-US", options);
    var dateElem = document.getElementById("ast_build_date");
    if (dateElem) {
      dateElem.textContent = ast_build_date;
    }
  })();
</script></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>